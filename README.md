# AstrBot 咸鱼之王宝箱识别插件

该插件通过OCR技术识别咸鱼之王游戏中的宝箱，自动计算积分并提供游戏策略建议。

## 功能特性

- 🖼 自动识别游戏截图中四种宝箱（木头/白银/黄金/铂金）
- 🧮 精确计算积分总量和可完成轮数
- ⏳ 60秒超时自动取消等待状态
- 📊 提供下一轮所需积分和推荐闯关数
- 📱 支持QQ群聊和个人消息互动

## 安装方法

1. 将插件复制到AstrBot的插件目录：
   ```bash
   cp astrbot_plugin_xyzw_box /AstrBot/data/plugins/
   ```

2. 安装必要的Python依赖：
   ```bash
   pip install pillow requests aiohttp
   ```

3. 修改AstrBot配置文件，添加插件和OCR服务配置：
   ```yaml
   plugins:
     astrbot_plugin_xyzw_box:
       ocr_url: "https://your-ocr-service.com/api"
       ocr_key: "your_api_key_here"
   ```

4. 重启AstrBot使插件生效

## 使用说明

1. 在QQ聊天中发送命令触发识别流程：
   ```
   xyzw
   ```

2. 根据机器人提示，在60秒内发送游戏截图：
   ```
   🖼🖼🖼️ 请发送宝箱截图（60秒内）
   ```

3. 等待处理结果（约5-10秒）：
   ```
   🔍 开始处理图片...
   ✅ 识别完成
   📦 木头箱: 5
   🥈 白银箱: 3
   🥇 黄金箱: 2
   💎 铂金箱: 1
   🔄 可完成轮数: 2
   🎯 当前积分: 145
   🚧 下一轮还需: 195
   ⚔️ 推荐闯关数: 78.0
   ```

## 配置选项

| 配置项     | 必须 | 默认值                             | 描述                     |
|------------|------|------------------------------------|--------------------------|
| `ocr_url`  | 是   | 无                                 | OCR服务的API地址         |
| `ocr_key`  | 是   | 无                                 | OCR服务的API密钥         |

## 常见问题

**Q：提示"OCR服务错误：API Key is not specified"**
> 需要在配置文件中正确设置`ocr_key`参数，申请有效的OCR服务API密钥

**Q：图片处理失败**
> 确保截图清晰完整，包含所有宝箱和顶部积分信息。游戏更新后可能需要调整截图区域

**Q：识别结果不准确**
> 尝试重新截图，确保游戏界面没有遮挡。复杂背景可能影响OCR精度

**Q：机器人无响应**
> 检查网络连接是否正常，确认OCR服务可用。可通过日志查看详细错误信息

## 开发者信息

- 作者: cloudcranesss
- 版本: 1.0.1
- 更新日期: 2025-06-14

## 开源协议

本项目采用 [MIT 开源协议](LICENSE)，允许自由使用和修改，但需保留原作者信息。
